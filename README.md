# Прогнозирование продолжительности поездок такси в Нью-Йорке

## Описание проекта

Этот проект направлен на построение модели машинного обучения, способной предсказывать общую продолжительность поездки такси в Нью-Йорке. Существует множество факторов, влияющих на время поездки, таких как начальная и конечная точки маршрута, время суток, погодные условия и другие. Цель проекта — определить наиболее значимые характеристики и на их основе создать модель, которая сможет точно предсказывать время поездки, что в дальнейшем позволит прогнозировать её стоимость.

## Постановка задачи

### Бизнес-задача

Определить характеристики, влияющие на длительность поездки такси, и с их помощью спрогнозировать время поездки. Это позволит более точно определять стоимость поездки для клиентов и оптимизировать маршруты для водителей.

### Техническая задача

Построить модель машинного обучения, которая будет предсказывать время поездки такси на основе предложенных характеристик.

## Основные цели проекта

1. Сформировать набор данных на основе нескольких источников информации.
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые для построения модели.
3. Исследовать предоставленные данные и выявить закономерности.
4. Построить несколько моделей и выбрать из них наилучшую по заданной метрике.
5. Спроектировать процесс предсказания времени длительности поездки для новых данных.

## Знакомство с данными, базовый анализ и расширение данных


- Определение временных рамок: Установление периода, в котором будут проанализированы данные.
- Обработка пропусков в данных: Выявление и заполнение отсутствующих значений.
- Статистические характеристики признаков: Анализ основных статистических показателей.
- Функция добавления временных характеристик: Создание новых признаков на основе времени.
- Функция добавления информации о праздничных днях: Включение данных о праздничных днях для улучшения прогноза.
- Функция добавления данных OSRM: Интеграция данных маршрутизации для расчета расстояний.
- Функция добавления географических признаков: Генерация признаков, связанных с географическим положением.
- Функция разбиения на географические кластеры: Группировка данных на основе географического расположения.
- Функция добавления погодных признаков: Включение данных о погоде для анализа влияния погодных условий на время поездки.
- Заполнение пропусков в данных: Окончательное заполнение отсутствующих значений после расширения данных.

## Разведывательный анализ данных (EDA)
Разведывательный анализ данных (EDA) помогает глубже понять данные, выявить закономерности и аномалии. В данном проекте были выполнены следующие этапы анализа:

- Диаграмма длительности поездок в логарифмическом масштабе
- Анализ распределений длительности поездки в зависимости от различных факторов, таких как таксопарк, время суток, дни недели
- Построение scatter-диаграмм для визуализации географического распределения поездок

## Отбор и преобразование признаков

Для успешного моделирования необходимо правильно выбрать и трансформировать признаки:

- Кодировка признаков: Преобразование категориальных признаков в числовой вид.
- Кодировка One-hot encoding: Разделение категориальных признаков на отдельные бинарные столбцы.
- Отбор признаков K-best: Выбор наиболее значимых признаков на основе статистических критериев.
- Масштабирование факторов: Нормализация признаков для улучшения работы моделей.

## Линейная регрессия: Простейшая модель для предсказания числовых значений.
- Полиномиальные признаки: Создание полиномиальных признаков для улучшения линейной регрессии.
- L2-регуляризация: Добавление регуляризации для борьбы с переобучением.
- DecisionTreeRegressor: Использование дерева решений для построения модели.
- Подбор глубины дерева: Оптимизация гиперпараметра для дерева решений.

## Ансамблевые методы и построение прогноза
Для повышения точности предсказаний были применены ансамблевые методы:

- Random Forest: Метод случайного леса для повышения точности модели.
- GradientBoostingRegressor: Градиентный бустинг для улучшения предсказательной способности.
- Коэффициенты значимости: Анализ важности признаков в итоговой модели.
- Расчет медианной абсолютной ошибки (MeAE): Оценка точности модели с использованием MeAE.
- XG-boost: Применение XG-boost для финального улучшения модели.

## Заключение
В ходе данного проекта была успешно решена задача предсказания длительности поездки такси в Нью-Йорке с использованием методов машинного обучения. Мы прошли через все ключевые этапы обработки и анализа данных, начиная от знакомства с данными и их очистки до построения и оценки различных моделей.